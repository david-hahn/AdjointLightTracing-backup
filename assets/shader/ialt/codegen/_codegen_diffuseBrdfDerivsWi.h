float t0 = 0;
  float t1 = 0;
float t2 = 0;
float t3 = eta_ext*eta_ext;
float t4 = eta_ext*eta_ext*eta_ext;
bool t5 = (eta_ext != 0.0);
float t6 = 1.0/eta_int;
float t8 = -lp1;
float t9 = -lp2;
float t10 = -lp3;
float t7 = t6*t6;
float t11 = hp1+t8;
float t12 = hp2+t9;
float t13 = hp3+t10;
bool t20 = ((eta_int == eta_ext) && t5);
float t14 = abs(t11);
float t15 = abs(t12);
float t16 = abs(t13);
float t17 = (t11/abs(t11));
float t18 = (t12/abs(t12));
float t19 = (t13/abs(t13));
float t21 = t11*t11;
float t22 = t12*t12;
float t23 = t13*t13;
float t24 = t14*t14;
float t25 = t15*t15;
float t26 = t16*t16;
float t27 = t21+t22+t23;
float t28 = t24+t25+t26;
float t29 = 1.0/sqrt(t27);
float t30 = 1.0/sqrt(t28);
float t38 = n1*t11*t29;
float t39 = n2*t12*t29;
float t40 = n3*t13*t29;
float t31 = t30*t30*t30;
float t32 = n1*t30;
float t33 = n2*t30;
float t34 = n3*t30;
float t53 = t38+t39+t40;
float t35 = -t32;
float t36 = -t33;
float t37 = -t34;
float t41 = t11*t32;
float t42 = t12*t33;
float t43 = t13*t34;
float t44 = n1*t11*t14*t17*t31;
float t45 = n2*t12*t14*t17*t31;
float t46 = n1*t11*t15*t18*t31;
float t47 = n3*t13*t14*t17*t31;
float t48 = n2*t12*t15*t18*t31;
float t49 = n1*t11*t16*t19*t31;
float t50 = n3*t13*t15*t18*t31;
float t51 = n2*t12*t16*t19*t31;
float t52 = n3*t13*t16*t19*t31;
float t54 = t53*t53;
float t55 = t54-1.0;
float t56 = t41+t42+t43;
float t74 = t35+t44+t45+t47;
float t75 = t36+t46+t48+t50;
float t76 = t37+t49+t51+t52;
float t57 = abs(t56);
float t58 = (t56/abs(t56));
float t62 = t3*t7*t55;
float t59 = eta_int*t57;
float t60 = eta_ext*t57;
float t61 = t57*t57;
bool t64 = (t62 < -1.0);
float t87 = eta_int*t58*t74;
float t88 = eta_ext*t58*t74;
float t89 = eta_int*t58*t75;
float t90 = eta_ext*t58*t75;
float t91 = eta_int*t58*t76;
float t92 = eta_ext*t58*t76;
float t63 = t61-1.0;
bool t66 = (t20 || t64);
float t65 = t3*t7*t63;
float t67 = t65+1.0;
float t68 = sqrt(t67);
float t69 = 1.0/t68;
float t70 = eta_int*t68;
float t71 = eta_ext*t68;
float t72 = -t70;
float t73 = -t71;
float t77 = t59+t71;
float t78 = t60+t70;
float t93 = t3*t6*t57*t58*t69*t74;
float t94 = t4*t7*t57*t58*t69*t74;
float t95 = t3*t6*t57*t58*t69*t75;
float t96 = t4*t7*t57*t58*t69*t75;
float t97 = t3*t6*t57*t58*t69*t76;
float t98 = t4*t7*t57*t58*t69*t76;
float t79 = t59+t73;
float t80 = t60+t72;
float t81 = 1.0/(t77*t77);
float t82 = 1.0/(t78*t78);
float t83 = 1.0/(t77*t77*t77);
float t84 = 1.0/(t78*t78*t78);
float t85 = t79*t79;
float t86 = t80*t80;
  if (t66) {
    t0 = 0.0;
  } else {
    t0 = -(eta_ext*t58*(t35+t44+t45+t47)-t3*t6*t57*t58*1.0/sqrt(t65+1.0)*(t35+t44+t45+t47))*1.0/pow(t60+eta_int*sqrt(t65+1.0),2.0)*(t60-eta_int*sqrt(t65+1.0))-1.0/pow(t59+eta_ext*sqrt(t65+1.0),2.0)*(t59-eta_ext*sqrt(t65+1.0))*(eta_int*t58*(t35+t44+t45+t47)-t4*t7*t57*t58*1.0/sqrt(t65+1.0)*(t35+t44+t45+t47))+t85*1.0/pow(t59+eta_ext*sqrt(t65+1.0),3.0)*(eta_int*t58*(t35+t44+t45+t47)+t4*t7*t57*t58*1.0/sqrt(t65+1.0)*(t35+t44+t45+t47))+t86*1.0/pow(t60+eta_int*sqrt(t65+1.0),3.0)*(eta_ext*t58*(t35+t44+t45+t47)+t3*t6*t57*t58*1.0/sqrt(t65+1.0)*(t35+t44+t45+t47));
  }
  if (t66) {
    t1 = 0.0;
  } else {
    t1 = -(eta_ext*t58*(t36+t46+t48+t50)-t3*t6*t57*t58*1.0/sqrt(t65+1.0)*(t36+t46+t48+t50))*1.0/pow(t60+eta_int*sqrt(t65+1.0),2.0)*(t60-eta_int*sqrt(t65+1.0))-1.0/pow(t59+eta_ext*sqrt(t65+1.0),2.0)*(t59-eta_ext*sqrt(t65+1.0))*(eta_int*t58*(t36+t46+t48+t50)-t4*t7*t57*t58*1.0/sqrt(t65+1.0)*(t36+t46+t48+t50))+t85*1.0/pow(t59+eta_ext*sqrt(t65+1.0),3.0)*(eta_int*t58*(t36+t46+t48+t50)+t4*t7*t57*t58*1.0/sqrt(t65+1.0)*(t36+t46+t48+t50))+t86*1.0/pow(t60+eta_int*sqrt(t65+1.0),3.0)*(eta_ext*t58*(t36+t46+t48+t50)+t3*t6*t57*t58*1.0/sqrt(t65+1.0)*(t36+t46+t48+t50));
  }
  if (t66) {
    t2 = 0.0;
  } else {
    t2 = -(eta_ext*t58*(t37+t49+t51+t52)-t3*t6*t57*t58*1.0/sqrt(t65+1.0)*(t37+t49+t51+t52))*1.0/pow(t60+eta_int*sqrt(t65+1.0),2.0)*(t60-eta_int*sqrt(t65+1.0))-1.0/pow(t59+eta_ext*sqrt(t65+1.0),2.0)*(t59-eta_ext*sqrt(t65+1.0))*(eta_int*t58*(t37+t49+t51+t52)-t4*t7*t57*t58*1.0/sqrt(t65+1.0)*(t37+t49+t51+t52))+t85*1.0/pow(t59+eta_ext*sqrt(t65+1.0),3.0)*(eta_int*t58*(t37+t49+t51+t52)+t4*t7*t57*t58*1.0/sqrt(t65+1.0)*(t37+t49+t51+t52))+t86*1.0/pow(t60+eta_int*sqrt(t65+1.0),3.0)*(eta_ext*t58*(t37+t49+t51+t52)+t3*t6*t57*t58*1.0/sqrt(t65+1.0)*(t37+t49+t51+t52));
  }
gradDiffuse[0] = t0;
gradDiffuse[1] = t1;
gradDiffuse[2] = t2;
